---
title: "Informe HDT1"
author: "Marco Ramirez 19588-Alfredo Queza, Estuardo Hernandez"
date: "04/4/2022"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
```{r, include=FALSE}
datos<-read.csv('movies.csv')
##summary(datos) #Resumen de los datos
##nrow(datos) #Cantidad de columnas
#ncol(datos) #Cantidad de columnas
#str(datos) #Estructura de los datos
#names(datos)
```
# Hoja de Trabajo 1: Analisis exploratorio

El objetivo de esta hoja de trabajo era realizar un analisis exploratorio a la base de datos de peliculas, extraido de IMDB. Es base cuenta con `r nrow(datos)` filas y con `r ncol(datos)` de columnas.

### 1. Haga una exploración rápida de sus datos, para eso haga un resumen de su conjunto de datos. 

```{r}
summary(datos)
```

### 2. Diga el tipo de cada una de las variables (cualitativa ordinal o nominal, cuantitativa continua, cuantitativa discreta)
![Caption for the picture.](/Users/MAQUITO/Desktop/UVG/UVG S7/Mineria de datos/HDT1/HDT1_F/HT1_Mineria/Ejercicio2.png)

### 3. Investigue si las variables cuantitativas siguen una distribución normal y haga una tabla de frecuencias de las variables cualitativas. Explique todos los resultados.  
### 4. Responda las siguientes preguntas
###  4.1. ¿Cuáles son las 10 películas que contaron con más presupuesto? 
```{r , include=FALSE}
    
library(tibbletime)
library(dplyr)
library(tidyverse)

datos[,'id']
datos[,'budget']
datos[,'originalTitle']


id<-datos[,'id']
original_title<-datos[,'originalTitle']
presu<-datos[,'budget']



q3<-data.frame(original_title,presu)

ask3<-q3[order(-q3$presu),]
ask3f<-head(ask3,n=10)

pregunta1<-ggplot(data=ask3f, aes(x=reorder(original_title,-presu) , y=presu,fill=original_title)) +
  geom_bar(stat="identity")+
  scale_y_continuous(labels=scales::dollar)+
  theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
  labs(title="Top 10 peliculas con mayor presupuesto", x="Peliculas", y="Presupuesto")

```
```{r}
pregunta1

```


\n
#### Como se observa en la grafica anterior las 10 peliculas con mayor presupuesto son:\n

1. **`r ask3f[1,1]`** con un presupuesto de **`r ask3f[1,2]`** dolares. <br/>
2. **`r ask3f[2,1]`** con un presupuesto de **`r ask3f[2,2]`** dolares.<br/>
3. **`r ask3f[3,1]`** con un presupuesto de **`r ask3f[3,2]`** dolares.<br/>
4. **`r ask3f[4,1]`** con un presupuesto de **`r ask3f[4,2]`** dolares.<br/>
5. **`r ask3f[5,1]`** con un presupuesto de **`r ask3f[5,2]`** dolares.<br/>
6. **`r ask3f[6,1]`** con un presupuesto de **`r ask3f[6,2]`** dolares.<br/>
7. **`r ask3f[7,1]`** con un presupuesto de **`r ask3f[7,2]`** dolares.<br/>
8. **`r ask3f[8,1]`** con un presupuesto de **`r ask3f[8,2]`** dolares.<br/>
9. **`r ask3f[9,1]`** con un presupuesto de **`r ask3f[9,2]`** dolares.<br/>
10. **`r ask3f[10,1]`** con un presupuesto de **`r ask3f[10,2]`** dolares.<br/>

###  4.2. ¿Cuáles son las 10 películas que más ingresos tuvieron?

###  4.3. ¿Cuál es la película que más votos tuvo? 


```{r include=FALSE}


datos[,'id']
datos[,'voteCount']
datos[,'originalTitle']


id<-datos[,'id']
Pelicula<-datos[,'originalTitle']
voteCount<-datos[('voteCount')]


q3<-data.frame(Pelicula,voteCount)
ask3<-q3[order(-q3$voteCount),]
ask3f<-head(ask3,n=5)






pregunta4.3<-ggplot(data=ask3f, aes(x=reorder(Pelicula,-voteCount) , y=voteCount,fill=Pelicula)) +
  geom_bar(stat="identity")+
  
  theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
  labs(title="Top 5 peliculas con mas votos en IMDB", x="Peliculas", y="Votos")



```

```{r}
pregunta4.3

```


#### Como se observa en la grafica anterior las 10 peliculas con mayor presupuesto son:\n

1. **`r ask3f[1,1]`** con **`r ask3f[1,2]`** de  votos. <br/>
2. **`r ask3f[2,1]`** con **`r ask3f[2,2]`** de  votos.<br/>
3. **`r ask3f[3,1]`** con **`r ask3f[3,2]`** de  votos.<br/>
4. **`r ask3f[4,1]`** con **`r ask3f[4,2]`** de  votos.<br/>
5. **`r ask3f[5,1]`** con **`r ask3f[5,2]`** de  votos.<br/>



###  4.4. ¿Cuál es la peor película de acuerdo a los votos de todos los usuarios?

###  4.5. ¿Cuántas  películas  se  hicieron  en  cada  año?  ¿En  qué  año  se  hicieron  más películas? Haga un gráfico            de barras 

###  4.6. ¿Cuál es el género principal de las 20 películas más recientes? ¿Cuál es el género principal que predomina en el             conjunto de datos? Represéntelo usando un gráfico 


```{r include=FALSE}
library(tidyverse)
id<-datos[,'id']
original_title<-datos[,'originalTitle']
genres_amount<-datos[,'genresAmount']


genre<-datos[,'genres']

release_date<-datos[,'releaseDate']


ask6<-data.frame(original_title,genre,release_date)
ask6order<-ask6[rev(order(as.Date(ask6$release_date,format="%Y-%m-%d"))),]
ans6<-ask6order[!ask6order$genre=="",]
ask6orderf<-head(ans6,n=20)




data6<-ask6orderf
datas<-data6 %>%
  group_by(genre) %>%
  tally()

datas<-datas[order(-datas$n),]


genero<-datas$genre

pregunta4.6<-ggplot(data=datas, aes(x=genre, y=n,fill=genero)) +
  geom_bar(stat="identity")+
    theme(axis.text.x = element_text(angle = 60, vjust = 1, hjust=1))+
  labs(title="Genero principal de las 20 peliculas mas recientes", x="Genero", y="Cantidad")


```
```{r}
pregunta4.6
```

#### Como se observa en la grafica anterior los generos principales de las 20 peliculas mas recientes son:

1. **`r datas[1,1]`** repitiendose **`r datas[1,2]`** veces. <br/>
2. **`r datas[2,1]`** repitiendose **`r datas[2,2]`** veces. <br/>
3. **El resto de generos** repitiendose **`r datas[3,2]`** veces. <br/>


